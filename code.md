**AI-MEME コード規約**

## 重要

- 記事ページはデプロイするが、CMS は本番デプロイを行わない。
  - 理由はセキュリティコストを減らす。
  - AI の API を叩く機能があるのであらぬ料金を発生させたくない。
  - 認証なども不要になる。

## ディレクトリ

#### ＊ 構成について

- Feature 型、Layout 型のいいとこ取りを採用
  _/docs/directory.md を参照_

#### ＊ APP Router について

- ページルーティング、API ルーティングされてしまうフォルダーをまとめる場合は、`(pages)/page.tsx`のようにする

#### ＊ Components について

- 部品の階層

  > 例: `/components/elements/Button.tsx`とする。

  コンポネント自体はファイルごとで定義する。　
  Stories,Test,Module.css を運用する予定がないため

- 命名規則

  ファイル名の先頭は大文字にする

#### ＊ ファイルの拡張子について（tsx,ts）

- 例外を除いて、基本的に TypeScript ファイルを使用する。

- HTML が存在しないものは「ts」、するものは「tsx」にする。

#### ＊ ファイルインポートについて

- 極力、エイリアスを使うこと　例：`@/~~`

## API

#### ＊ 全般

- API の util、config は**lib ディレクトリ**に配置する。

#### ＊ エンドポイントについて

- Next.js の AppRouter で TypeScript で記述
- HTTP メソッドでは、**CRUD**を採用
- 命名規則

  - 例： `/api/read/v1/`
  - 読み取りだけなら**read**の階層へ
  - 書き込みなら**write**の階層へ
  - バージョン**vOO**の階層へ

- **QUERY**、**PATH**パラメーターは、適切に用いる。

  > QUERY → 条件を指定するときなど
  > PATH → DB の ID を指定するときなど

- クエリ、パスパラメーターは、適切に用いる。

  - パス → DB の ID を指定するときなど使用
  - クエリ → 条件を指定するときなど使用

#### ＊ API の呼び出しについて

- API を呼び出す**Hooks**を作成すること。

- useCallback などで呼び出し時、ラップすること
  （不要な呼び出しを減らす）

#### ＊ セキュリティ

- JWT での API 認証を行う

#### ＊ レスポンスについて

- JSON 形式で記載すること

#### ＊ エラーコードについて

- エラーコードを設定する。
- もし中身があれば、それに伴うエラー処理を行う。 - エラーで特別な処理が発生する API にのみ持たせる
<!-- TODO: 後で書く -->
- 命名規則

#### ＊ API ドキュメントについて

- openAPI Swagger
  - 厳密に書く必要はない。開発の指標程度で大丈夫。

#### ＊ Mock について

- 厳密に書く必要はない。（個人的な理由で置いている）
- isProduction 関数で local,dev で切り替えできるようには作っているが、あくまで一応。

## プログラミング

#### ＊ 全般

- 関数
  - 基本、**アロー関数**を使用する
  - 戻り値、引数の型定義を行う
  - 引数が多すぎる時（4 つ以上）は、Object を使用する。
  - var は使用しない
  - 配列やオブジェクトへの追加、更新、削除は基本的に**スプレッド構文**で行う。
- 配列
  - itemList ではなく items などの複数形を使う
- オブジェクト
  - オブジェクトの命名は、**Data**,**Info**,**Response**のどれかをつける
- 繰り返し
  - for 文、forEach 文はなるべく使わず、
    map や filter などを使う
  - もし万が一 for 文を使いざる負えない場合は、
    拡張 for 文を使用する。
- 条件分岐
  - else がない場合は即 return する
  - ==ではなく===を使用する。
  - if(!hoge) は使用しない。エラーの元
  - jsx 内は、シンプルな三項演算子のみ。複雑なものは関数を定義する。
- React/Next
  - useEffect 内で複雑な処理を記述しない。関数に切り分けること
  - pages 配下以外は export default は使用しない

#### ＊ 命名規則

1. 変数命名の採用ケース
   - JavaScript
     - 基本的には、**camelCase**
     - 関数は、**camelCase で最初の単語は動詞**
     - コンポネントは、**PascalCase**
     - 型定義変数は、**PascalCase**
     - 定数や環境変数は、**UPPER_SNAKE_CASE**
   - CSS,HTML（Class 名など）
     - 基本的には、**kebab-case**
   - DB
     - 基本的には、**snake_case**
2. 変数名は極力、省略しない。
3. ブール型変数は、`is`、`has`などの接頭辞を先頭に付ける。

#### ＊ React

1. State

   - RecoilState を使用して、状態管理を行う。

     - RecoilState の呼び出しは**PageComponent**で行う。
     - 機密性の高いもの、特例以外は、
       基本 State の中身は`session-storage`で管理

2. Components - 可能な限り関数コンポーネントを使用する。 - **Props**に適切な型を定義する。
   （ファイルトップに Type で Props を宣言する）

3. Hooks
   - API の呼び出しの Hooks の命名規則
     - 対象の CRUD を接頭辞の先頭に付ける
   - Hooks の関数を代入後、呼び出す時は「call」を接頭辞の先頭に付ける

#### ＊ TypeScript

1. `interface`は基本使わない。

2. 型推論で型定義されている箇所は、定義不要。
3. 複雑な Object、わかりづらいものに関して、型定義してよし
4. any は極力使わないこと。
5. 型に入る値が初めから決まっているものは、
   それを`|`で定義する。
6. ジェネリクスを使用する際は、T を接頭辞を先頭に付けて、その後命名する。

#### ＊ CSS(TailWind)

1. カスタムで色、フォント etc が必要になった場合のみ、
   `tailwind.config.js`に記述する。

2. ⓵ 以外で、カスタムで必要になった場合は、
   `global.css` にてユーティリティを独自に作成する。直感的にわかるクラスを採用する。
3. **rem**は、基本使わないこと。

#### ＊ HTML

1. 何の意図かわかりづらい HTML 要素は、
   明示的にわかるクラスを先頭に付与する。
   **PascalCase**で指定する。
   これにスタイルは当てないこと。
   （Tailwind だと何の要素かわかりづらいため）

2. アクセシビリティを意識して適切な要素を使うこと。

#### ＊ コメント

- わかりにくい箇所だけコメントする
- `/** **/` を使用して関数の説明を書くこと

#### ＊ その他

1. Lint エラーは極力「リントディスエーブルコメント」で解決しない。
2. エラーや警告（dev ツール）で表示されるものは基本解決すること。

#### ＊ 思想

- **DRY（Don't Repeat Yourself）**: 同じコードを繰り返さないようにし、関数やモジュールにまとめる。
- **KISS（Keep It Simple, Stupid）**: コードはシンプルに保つ。複雑なロジックは避ける。
- **YAGNI（You Ain't Gonna Need It）**: 将来的に使うかもしれないコードは書かない。
